{"version":3,"sources":["webpack:///webpack/bootstrap 53ebec7677f84f334564","webpack:///./node_modules/babel-runtime/regenerator/index.js","webpack:///./src/app/models/User.js","webpack:///external \"lodash\"","webpack:///./src/app/middlewares/Auth.js","webpack:///./src/app/middlewares/Token.js","webpack:///./src/index.js","webpack:///./src/globals/index.js","webpack:///./src/globals/modules.js","webpack:///external \"shery-logger\"","webpack:///external \"mongoose\"","webpack:///external \"mongoose-timestamp\"","webpack:///external \"async\"","webpack:///external \"validator\"","webpack:///external \"morgan\"","webpack:///external \"body-parser\"","webpack:///external \"path\"","webpack:///external \"bcrypt\"","webpack:///external \"jsonwebtoken\"","webpack:///external \"express\"","webpack:///external \"dotenv\"","webpack:///./src/globals/vars.js","webpack:///./src/config/env.js","webpack:///./src/config/project.js","webpack:///./src/config/database.js","webpack:///./src/app/routes/index.js","webpack:///./src/app/routes/users.js","webpack:///external \"regenerator-runtime\"","webpack:///./src/app/models/sensitive/Hash.js","webpack:///./src/app/controllers/UsersController.js","webpack:///./src/app/routes/switches.js","webpack:///./src/app/controllers/SwitchesController.js","webpack:///./src/app/models/Switch.js","webpack:///./src/app/middlewares/CORS.js","webpack:///./src/app/middlewares/ExpressPlugins.js","webpack:///./src/app/middlewares/isValid.js"],"names":["userSchema","mongoose","Schema","fName","type","String","lName","username","required","plugin","mongooseTimestamp","virtual","set","password","Hash","update","user","_id","hash","upsert","statics","authorize","Promise","resolve","reject","findOne","savedHash","bcrypt","compare","match","model","TOKENKEY","req","res","next","headers","api_token","validSend","verify","verified","error","_","mapKeys","value","key","auth","config","basedCollection","useridKey","validationConfig","valid","userid","docid","validation","jwt","sign","process","env","JWT_SECRET","schema","doc","token","authenticationInfo","User","findById","result","projectMode","console","activeLevel","intro","Name","Project","Description","Notes","Mode","app","express","use","bodyParser","json","routes","post","message","static","path","join","__dirname","err","Error","status","port","API_PORT","listen","info","Number","name","global","globals","sherylogger","require","async","validator","logger","dotenv","dotenvPath","argv","forEach","val","index","array","DevProjectInfoKeys","omit","DB_USERNAME","DB_PASSWORD","DB_HOST","DB_PORT","DB_NAME","mongoOptions","useMongoClient","loginInfo","authSource","DB_AUTHSOURCE","uri","connect","db","connection","on","bind","once","log","Router","getUpdate","$set","doHash","hashSchema","SchemaTypes","ObjectId","ref","pre","register","validate","body","newUser","save","savedUser","tokenize","registered","JSON","stringify","login","authenticated","me","newSwitch","ip","description","sw","savedSW","switch","allSwitches","Switch","find","swList","switches","switchSchema","CORS","header","validators","isValid","findKeys","object","keys","foundKeys","notFoundKeys","push","objectValue","objectKey","pop","deepOmit","_doc","mapper","Object","o","length","level","map","v","k","okey","newObject","e","requiredKeys","forbiddenKeys","missedKeys","notAllowedKeys","omitKeys","isJSON","defaultOmitKeys","ok"],"mappings":";;;AAAA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,aAAK;AACL;AACA;;AAEA;AACA;AACA;AACA,mCAA2B,0BAA0B,EAAE;AACvD,yCAAiC,eAAe;AAChD;AACA;AACA;;AAEA;AACA,8DAAsD,+DAA+D;;AAErH;AACA;;AAEA;AACA;;;;;;;AC7DA;;;;;;;;;;;;;;;ACAA;;;;;AAKA;;AAGA,IAAIA,aAAaC,SAASC,MAAT,CAAgB;;AAEhCC,QAAO;AACNC,QAAMC;;AADA,EAFyB,EAK9BC,OAAO;AACRF,QAAMC;;AADE,EALuB,EAQ9BE,UAAU;AACXH,QAAMC,MADK;AAEXG,YAAU;AAFC;AARoB,CAAhB,CAAjB;;AAcAR,WAAWS,MAAX,CAAkBC,iBAAlB;AACA;AACAV,WAAWW,OAAX,CAAmB,UAAnB,EAA+BC,GAA/B;AAAA,2KAAmC,iBAAeC,QAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aACrB,gEAAAC,CAAKC,MAAL,CAAY,EAACC,MAAK,KAAKC,GAAX,EAAZ,EAA4B,EAACD,MAAK,KAAKC,GAAX,EAAeC,MAAKL,QAApB,EAA5B,EAA0D,EAACM,QAAO,IAAR,EAA1D,CADqB;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAnC;;AAAA;AAAA;AAAA;AAAA;;AAIA;AACAnB,WAAWoB,OAAX,CAAmBC,SAAnB,GAA8B,UAASL,IAAT,EAAc;AAC3C,QAAO,IAAIM,OAAJ;AAAA,6KAAY,kBAAeC,OAAf,EAAuBC,MAAvB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,cAGG,gEAAAV,CAAKW,OAAL,CAAa,EAACT,MAAKA,KAAKC,GAAX,EAAb,CAHH;;AAAA;AAGbS,gBAHa;;AAAA,WAIbA,SAJa;AAAA;AAAA;AAAA;;AAAA,yCAIKF,OAAO,oBAAP,CAJL;;AAAA;AAAA;AAAA,cAODG,OAAOC,OAAP,CAAeZ,KAAKH,QAApB,EAA6Ba,UAAUR,IAAvC,CAPC;;AAAA;AAObW,YAPa;;AAAA,YAQdA,KARc;AAAA;AAAA;AAAA;;AAAA,yCAQAN,QAAQ,IAAR,CARA;;AAAA;AAAA,yCASVA,QAAQ,KAAR,CATU;;AAAA;AAAA;AAAA;AAAA,yCAWVC,oBAXU;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAZ;;AAAA;AAAA;AAAA;AAAA,KAAP;AAeA,CAhBD;;AAoBA,yDAAevB,SAAS6B,KAAT,CAAe,MAAf,EAAuB9B,UAAvB,CAAf,E;;;;;;ACjDA,mC;;;;;;;;;;;;;;;ACAA;;;;;AAKA;AACA;AAGA;AACA,IAAM+B,WAAS,gBAAf;;AAEA;AACA;AAAA,2KAAe,iBAAoBC,GAApB,EAAyBC,GAAzB,EAA8BC,IAA9B;AAAA;AAAA;AAAA;AAAA;AAAA;AACd;AACA,UAAIF,IAAIG,OAAJ,CAAYJ,QAAZ,CAAJ,EAA+BK,SAA/B,GAA2CJ,IAAIG,OAAJ,CAAYJ,QAAZ,CAA3C;AACA;;AAHc,UAITK,SAJS;AAAA;AAAA;AAAA;;AAAA,uCAISH,IAAII,SAAJ,CAAc,GAAd,EAAmB,2DAAyDN,QAAzD,GAAkE,IAArF,CAJT;;AAAA;AAAA;AAAA,aAMO,8DAAAO,CAAOF,SAAP,CANP;;AAAA;AAMVG,cANU;;AAAA,WAQVA,SAASC,KARC;AAAA;AAAA;AAAA;;AAAA,uCAQaP,IAAII,SAAJ,CAAc,GAAd,EAAmBE,QAAnB,CARb;;AAAA;AASd;AACAE,QAAEC,OAAF,CAAUH,QAAV,EAAoB,UAACI,KAAD,EAAQC,GAAR,EAAgB;AACnC,cAAOZ,IAAIY,GAAJ,IAAWD,KAAlB;AACA,OAFD;;AAIAT;;AAdc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EAAf;;AAAA,UAA8BW,IAA9B;AAAA;AAAA;;AAAA,QAA8BA,IAA9B;AAAA,M;;;;;;;;;;;;;;;;;;;ACbA;;;;;AAKA;;AAEA;AACA;;;;;;;;;;AAUA,IAAIC,SAAS;AACTC,qBAAiB,MADR;AAETC,eAAW;AAFF,CAAb;;AAKA,IAAIC,mBAAmB,SAAnBA,gBAAmB,GAAM;AACzB,QAAI,CAACH,MAAL,EAAa,OAAO;AAChBI,eAAO,KADS;AAEhBV,eAAO;AAFS,KAAP;AAIb,QAAI,CAACM,OAAOC,eAAZ,EAA6B,OAAO;AAChCG,eAAO,KADyB;AAEhCV,eAAO;AAFyB,KAAP;AAI7B,QAAI,CAACM,OAAOE,SAAZ,EAAuB,OAAO;AAC1BE,eAAO,KADmB;AAE1BV,eAAO;AAFmB,KAAP;AAIvB,WAAO;AACHU,eAAO;AADJ,KAAP;AAIH,CAjBD;AAkBA;AACA;;;;yDAIA;AAAA,8KAAe,iBAAMC,MAAN,EAAcC,KAAd;AAAA;AAAA;AAAA;AAAA;AAAA;AACX;AACIC,kCAFO,GAEMJ,kBAFN;;AAAA,4BAGNI,WAAWH,KAHL;AAAA;AAAA;AAAA;;AAAA,yDAGmB;AAC1BV,mCAAOa,WAAWb;AADQ,yBAHnB;;AAAA;AAOPO,uCAPO,GASPD,MATO,CAOPC,eAPO,EAQPC,SARO,GASPF,MATO,CAQPE,SARO;AAUX;;AAVW,8BAWPD,mBAAmB,MAXZ;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAWiCO,IAAIC,IAAJ,CAAS;AACjDJ,0CADiD;AAEjDJ,4DAFiD;AAGjD9B,iCAAKkC;AAH4C,yBAAT,EAI1CK,QAAQC,GAAR,CAAYC,UAJ8B,CAXjC;;AAAA;AAAA;;AAAA;AAgBPC,8BAhBO,GAgBE1D,SAAS6B,KAAT,CAAeiB,eAAf,CAhBF;AAiBX;;AAjBW,4BAkBNK,KAlBM;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAmBSO,OAAOlC,OAAP,qBACXuB,SADW,EACCG,MADD,EAnBT;;AAAA;AAmBHS,2BAnBG;;AAAA,4BAsBFA,GAtBE;AAAA;AAAA;AAAA;;AAAA,yDAsBU;AACbpB,mCAAO,QAAQO,eAAR,GAA0B,0BAA1B,GAAuDC,SAAvD,GAAmE;AAD7D,yBAtBV;;AAAA;AAyBPI,gCAAMQ,IAAI3C,GAAV;;AAzBO;AAAA;AAAA,+BA4BEqC,IAAIC,IAAJ,CAAS;AAClBJ,0CADkB;AAElBJ,4DAFkB;AAGlBK;AAHkB,yBAAT,EAIXI,QAAQC,GAAR,CAAYC,UAJD,CA5BF;;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAf;;AAAA;AAAA;AAAA;AAAA;AAmCA;AACO,IAAIpB;AAAA,+KAAO,kBAAMuB,KAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAGmBP,IAAIhB,MAAJ,CAAWuB,KAAX,EAAiBL,QAAQC,GAAR,CAAYC,UAA7B,CAHnB;;AAAA;AAGNI,0CAHM;AAILf,uCAJK,GAI0Be,kBAJ1B,CAILf,eAJK,EAIWI,MAJX,GAI0BW,kBAJ1B,CAIWX,MAJX,EAIkBC,KAJlB,GAI0BU,kBAJ1B,CAIkBV,KAJlB;AAKV;;AALU;AAAA,+BAMK,6DAAAW,CAAKC,QAAL,CAAcb,MAAd,CANL;;AAAA;AAMNnC,4BANM;AAONiD,8BAPM,GAOC,EAACjD,UAAD,EAPD;;AAAA,8BASP+B,mBAAiB,MATV;AAAA;AAAA;AAAA;;AAUT;AACGY,8BAXM,GAWC1D,SAAS6B,KAAT,CAAeiB,eAAf,CAXD;AAAA;AAAA,+BAYIY,OAAOK,QAAP,CAAgBZ,KAAhB,CAZJ;;AAAA;AAYNQ,2BAZM;;AAaVK,+BAAOlB,eAAP,IAAwBa,GAAxB;;AAbU;AAAA,0DAgBHK,MAhBG;;AAAA;AAAA;AAAA;AAAA,0DAoBH,EAACzB,OAAM,qBAAP,EApBG;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAP;;AAAA;AAAA;AAAA;AAAA,GAAJ,C;;;;;;;;;;;;;;;;;;;;;;;AClFP;AAAA;;;;;AAKA;AACA;;AAEA;AACA,IAAIgB,QAAQC,GAAR,CAAYS,WAAZ,IAA2B,YAA/B,EAA6C;AAC3C;AACAC,UAAQrB,MAAR,CAAe;AACbsB,iBAAa;AADA,GAAf;AAGD;AACD;AACAD,QAAQE,KAAR,CAAc;AACZC,QAAM,gEAAAC,CAAQD,IADF;AAEZE,eAAa,gEAAAD,CAAQC,WAFT;AAGZC,SAAO,gEAAAF,CAAQE,KAHH;AAIZC,QAAMlB,QAAQC,GAAR,CAAYS;AAJN,CAAd;;AAOA;AACA;AACA;AACA;;AAEA,IAAMS,MAAMC,SAAZ;;AAGA;AACAD,IAAIE,GAAJ,CAAQC,WAAWC,IAAX,EAAR;AACAJ,IAAIE,GAAJ,CAAQ,sEAAR;AACAF,IAAIE,GAAJ,CAAQ,gFAAR;;AAEA;AACA,4DAAAG,CAAOC,IAAP,CAAY,GAAZ,EAAiB,UAACjD,GAAD,EAAMC,GAAN;AAAA,SAAcA,IAAI8C,IAAJ,CAAS;AACtCG,aAAS,gEAAAX,CAAQD,IAAR,GAAc;AADe,GAAT,CAAd;AAAA,CAAjB;AAGAK,IAAIE,GAAJ,CAAQ,MAAR,EAAgB,4DAAhB;AACAF,IAAIE,GAAJ,CAAQD,QAAQO,MAAR,CAAeC,KAAKC,IAAL,CAAUC,SAAV,EAAqB,WAArB,CAAf,CAAR;;AAEAX,IAAIE,GAAJ,CAAQ,UAAU7C,GAAV,EAAeC,GAAf,EAAoBC,IAApB,EAA0B;AAChC,MAAIqD,MAAM,IAAIC,KAAJ,CAAU,WAAV,CAAV;AACAD,MAAIE,MAAJ,GAAa,GAAb;AACAvD,OAAKqD,GAAL;AACD,CAJD;AAKAZ,IAAIE,GAAJ,CAAQ,UAACU,GAAD,EAAKvD,GAAL,EAASC,GAAT,EAAaC,IAAb,EAAoB;AAC1B,MAAG,CAACqD,GAAJ,EAAS,OAAOtD,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAAlB,CAAP;AACT,MAAG,CAACkD,IAAIE,MAAR,EAAeF,IAAIE,MAAJ,GAAW,GAAX;AACf,SAAOxD,IAAIwD,MAAJ,CAAWF,IAAIE,MAAf,EAAuBV,IAAvB,CAA4B,EAACvC,OAAM+C,IAAIL,OAAX,EAA5B,CAAP;AACD,CAJD;;AAMA,IAAMQ,OAAOlC,QAAQC,GAAR,CAAYkC,QAAZ,IAAwB,IAArC;;AAGAhB,IAAIiB,MAAJ,CAAWF,IAAX,EAAiB,UAACH,GAAD,EAAS;AACxB,MAAIA,GAAJ,EAAS;AACPpB,YAAQ3B,KAAR,CAAc+C,GAAd;AACD;;AAEDpB,UAAQ0B,IAAR,sBAAkCC,OAAOJ,IAAP,CAAlC;AACD,CAND,E;;;;;;;;;;;ACzDA;AAAA;;;;;AAKA;AACA;AACA,8CAAAjD,CAAEC,OAAF,CAAU,yDAAV,EAAmB,UAACC,KAAD,EAAQoD,IAAR,EAAiB;AAChCC,SAAOD,IAAP,IAAepD,KAAf;AACH,CAFD;;AAIA;AACAqD,OAAOC,OAAP,GAAiB,sDAAjB,C;;;;;;;ACZA;;;;;yDAKe;AACX;AACAC,iBAAY,mBAAAC,CAAQ,CAAR,CAFD;;AAIX;AACAlG,cAAU,mBAAAkG,CAAQ,EAAR,CALC;AAMXzF,uBAAkB,mBAAAyF,CAAQ,EAAR,CANP;;AAQX;AACA1D,OAAG,mBAAA0D,CAAQ,CAAR,CATQ;AAUXC,WAAO,mBAAAD,CAAQ,EAAR,CAVI;AAWXE,eAAW,mBAAAF,CAAQ,EAAR,CAXA;AAYXG,YAAQ,mBAAAH,CAAQ,EAAR,CAZG;AAaXrB,gBAAY,mBAAAqB,CAAQ,EAAR,CAbD;AAcXf,UAAK,mBAAAe,CAAQ,EAAR,CAdM;;AAgBX;AACAxE,YAAO,mBAAAwE,CAAQ,EAAR,CAjBI;AAkBX7C,SAAI,mBAAA6C,CAAQ,EAAR,CAlBO;;AAoBX;AACAvB,aAAS,mBAAAuB,CAAQ,EAAR,CArBE;;AAuBX;AACAI,YAAO,mBAAAJ,CAAQ,EAAR;AAxBI,CAAf,E;;;;;;ACLA,yC;;;;;;ACAA,qC;;;;;;ACAA,+C;;;;;;ACAA,kC;;;;;;ACAA,sC;;;;;;ACAA,mC;;;;;;ACAA,wC;;;;;;ACAA,iC;;;;;;ACAA,mC;;;;;;ACAA,yC;;;;;;ACAA,oC;;;;;;ACAA,mC;;;;;;;ACAA;;;;AAIA,yDAAe;AACX;AADW,CAAf,E;;;;;;ACJA;;;;;AAKA,IAAIK,aAAa,gBAAjB;AACA,IAAItC,cAAc,aAAlB;AACAV,QACGiD,IADH,CAEGC,OAFH,CAEW,UAACC,GAAD,EAAMC,KAAN,EAAaC,KAAb,EAAuB;AAC9B,UAAQF,GAAR;AACE,SAAK,cAAL;AACEzC,oBAAc,YAAd;AACA,aAAOsC,aAAa,YAApB;AACA;;AAEF;AACA;AAPF;AASD,CAZH;;AAcAD,OAAOzD,MAAP,CAAc;AACZsC,QAAMA,KAAK7D,OAAL,CAAa+D,SAAb,EAAwBkB,UAAxB;AADM,CAAd;AAGAhD,QAAQC,GAAR,CAAYS,WAAZ,GAAwBA,WAAxB,C;;;;;;;;ACxBA;;;;;AAKA,IAAIK,UAAU;;AAEVD,UAAM,aAFI;AAGVE,iBAAa,qBAHH;AAIVC,WAAO,CAAC,qBAAD,EAAwB,qBAAxB;;AAJG,CAAd;AAOA,IAAIqC,qBAAqB,CACrB,OADqB,CAAzB;AAIA,IAAItD,QAAQC,GAAR,CAAYS,WAAZ,IAA2B,YAA/B,EAA6C;AACzCK,cAAU9B,EAAEsE,IAAF,CAAOxC,OAAP,EAAgBuC,kBAAhB,CAAV;AACH;AACD,yDAAevC,OAAf,E;;;;;;ACnBA;;;;;AAKAtE,SAASqB,OAAT,GAAmB0E,OAAO1E,OAA1B;;mBAQIkC,QAAQC,G;IALXuD,W,gBAAAA,W;IACAC,W,gBAAAA,W;IACAC,O,gBAAAA,O;IACAC,O,gBAAAA,O;IACAC,O,gBAAAA,O;;;AAGD,IAAMC,eAAe;AACpBC,iBAAgB;AADI,CAArB;;AAIA;AACA,IAAIC,YAAY,EAAhB;AACA,IAAIC,aAAa,EAAjB;AACA,IAAIR,WAAJ,EAAiB;AAChBO,aAAYP,cAAc,GAAd,GAAoBC,WAApB,GAAkC,GAA9C;AACAO,cAAa,iBAAiBC,aAA9B;AACA;AACD,IAAIC,MAAM,eAAeH,SAAf,GAA2BL,OAA3B,GAAqC,GAArC,GAA2CC,OAA3C,GAAqD,GAArD,GAA2DC,OAA3D,GAAqEI,UAA/E;;AAEA;AACAvH,SAAS0H,OAAT,CAAiBD,GAAjB,EAAsBL,YAAtB;AACA,IAAMO,KAAK3H,SAAS4H,UAApB;;AAEA;AACAD,GAAGE,EAAH,CAAM,OAAN,EAAe3D,QAAQ3B,KAAR,CAAcuF,IAAd,CAAmB5D,OAAnB,EAA4B,2BAA5B,CAAf;AACAyD,GAAGI,IAAH,CAAQ,MAAR,EAAgB;AAAA,QAAM7D,QAAQ8D,GAAR,CAAY,4BAAZ,CAAN;AAAA,CAAhB,E;;;;;;;;AClCA;AAAA;;;;;AAKA,IAAMjD,SAASJ,QAAQsD,MAAR,EAAf;AACA;AACA;;AAEA;AACAlD,OAAOH,GAAP,CAAW,QAAX,EAAqB,uDAArB;AACAG,OAAOH,GAAP,CAAW,WAAX,EAAwB,0DAAxB;;AAEA,yDAAeG,MAAf,E;;;;;;;;ACbA;AAAA;;;;;AAKA,IAAMA,SAASJ,QAAQsD,MAAR,EAAf;;AAEA;AACA;;AAMA;AACAlD,OAAOC,IAAP,CAAY,WAAZ,EAAyB,8EAAzB;AACAD,OAAOC,IAAP,CAAY,QAAZ,EAAsB,2EAAtB;AACAD,OAAOC,IAAP,CAAY,KAAZ,EAAmB,kEAAnB,EAAyB,wEAAzB;;AAKA,yDAAeD,MAAf,E;;;;;;ACtBA,gD;;;;;;;;;;;ACiBA;;8KACA,iBAAsB9C,IAAtB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEYrB,gCAFZ,GAEuB,KAAKsH,SAAL,GAAiBC,IAAjB,CAAsBlH,IAF7C;AAAA;AAAA,+BAG2CS,OAAOT,IAAP,CAAYL,QAAZ,EAAsB,EAAtB,CAH3C;;AAAA;AAGQ,6BAAKsH,SAAL,GAAiBC,IAAjB,CAAsBlH,IAH9B;;AAIQgB;AAJR;AAAA;;AAAA;AAAA;AAAA;;AAMQA;;AANR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,K;;oBAAemG,M;;;;;;;AAlBf;;;;;;AAMA,IAAIC,aAAarI,SAASC,MAAT,CAAgB;;AAE7Bc,UAAM;AACFZ,cAAMH,SAASsI,WAAT,CAAqBC,QADzB;AAEFC,aAAK;AAFH,KAFuB;AAM7BvH,UAAMb;AANuB,CAAhB,CAAjB;;AASAiI,WAAW7H,MAAX,CAAkBC,iBAAlB;AAYA4H,WAAWI,GAAX,CAAe,QAAf,EAAyBL,MAAzB;AACAC,WAAWI,GAAX,CAAe,kBAAf,EAAmCL,MAAnC;;AAGA,yDAAepI,SAAS6B,KAAT,CAAe,MAAf,EAAuBwG,UAAvB,CAAf,E;;;;;;;;;;;;;;;;;;;;AC/BA;;;;;AAKA;AACA;;AAIA;AACO,IAAIK;AAAA,8KAAW,iBAAM3G,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,4BAEbF,IAAI4G,QAAJ,CAAa,CAAC,UAAD,EAAa,UAAb,CAAb,CAFa;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,oCASd5G,IAAI6G,IATU,EAKd1I,KALc,aAKdA,KALc,EAMdG,KANc,aAMdA,KANc,EAOdC,QAPc,aAOdA,QAPc,EAQdM,QARc,aAQdA,QARc;AAUlB;;AAVkB;AAAA,+BAWT,6DAAAkD,CAAKtC,OAAL,CAAa,EAAClB,kBAAD,EAAb,CAXS;;AAAA;AAAA;AAAA;AAAA;AAAA;;AAAA,yDAWwB0B,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAACG,OAAM,0BAAP,EAAlB,CAXxB;;AAAA;AAYlB;AACIsG,+BAbc,GAaJ,IAAI,6DAAJ,CAAS;AACnB3I,wCADmB;AAEnBG,wCAFmB;AAGnBC,8CAHmB;AAInBM;AAJmB,yBAAT,CAbI;AAAA;AAAA;AAAA,+BAqBQiI,QAAQC,IAAR,EArBR;;AAAA;AAqBVC,iCArBU;AAAA;AAAA,+BAuBI,2EAAAC,CAASD,UAAU/H,GAAnB,CAvBJ;;AAAA;AAuBV4C,6BAvBU;;;AAyBd;AACA5B,4BAAII,SAAJ,CAAc,GAAd,EAAmB;AACf6G,wCAAY,IADG;AAEfhE,qCAAS,wCAFM;AAGfrB,mCAAOA;AAHQ,yBAAnB;AA1Bc;AAAA;;AAAA;AAAA;AAAA;;AAgCd;AACA5B,4BAAII,SAAJ,CAAc,GAAd,EAAmB;AACfG,mCAAO2G,KAAKC,SAAL;AADQ,yBAAnB;;AAjCc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAX;;AAAA;AAAA;AAAA;AAAA,GAAJ;AAuCP;AACO,IAAIC;AAAA,+KAAQ,kBAAMrH,GAAN,EAAWC,GAAX,EAAgBC,IAAhB;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,4BAEVF,IAAI4G,QAAJ,CAAa,CAAC,UAAD,EAAa,UAAb,CAAb,CAFU;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,qCAOX5G,IAAI6G,IAPO,EAKXtI,QALW,cAKXA,QALW,EAMXM,QANW,cAMXA,QANW;AAAA;AAAA;AAAA,+BAUM,6DAAAkD,CAAKtC,OAAL,CAAa;AAC1BlB;AAD0B,yBAAb,CAVN;;AAAA;AAUPS,4BAVO;AAAA;AAAA,+BAce,6DAAA+C,CAAK1C,SAAL,CAAe;AACrCJ,iCAAKD,KAAKC,GAD2B;AAErCJ;AAFqC,yBAAf,CAdf;;AAAA;AAcPyI,qCAdO;;AAAA,6BAoBPA,aApBO;AAAA;AAAA;AAAA;;AAAA;AAAA,+BAqBW,2EAAAL,CAASjI,KAAKC,GAAd,CArBX;;AAAA;AAqBH4C,6BArBG;;AAAA;;AAuBX;AACA5B,4BAAII,SAAJ,CAAc,GAAd,EAAmB;AACfiH,wDADe;AAEfzF;AAFe,yBAAnB;AAxBW;AAAA;;AAAA;AAAA;AAAA;;AA6BX;AACA5B,4BAAII,SAAJ,CAAc,GAAd,EAAmB;AACfG,mCAAO2G,KAAKC,SAAL;AADQ,yBAAnB;;AA9BW;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAR;;AAAA;AAAA;AAAA;AAAA,GAAJ;AAmCP;AACO,IAAIG;AAAA,+KAAK,kBAAMvH,GAAN,EAAWC,GAAX;AAAA;AAAA;AAAA;AAAA;AACZ;AACAA,4BAAII,SAAJ,CAAc,GAAd,EAAmBL,IAAIhB,IAAvB;;AAFY;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAL;;AAAA;AAAA;AAAA;AAAA,GAAJ,C;;;;;;;;ACvFP;AAAA;;;;;AAKA,IAAMgE,SAASJ,QAAQsD,MAAR,EAAf;;AAEA;AACA;;AAGA;AACAlD,OAAOC,IAAP,CAAY,MAAZ,EAAmB,kEAAnB,EAAyB,kFAAzB;AACAD,OAAOC,IAAP,CAAY,MAAZ,EAAmB,kEAAnB,EAAyB,oFAAzB;;AAOA,yDAAeD,MAAf,E;;;;;;;;;;;;;;;;;;ACpBA;;AAEA;AACO,IAAIwE;AAAA,8KAAU,iBAAMxH,GAAN,EAAUC,GAAV;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA,4BACbD,IAAI4G,QAAJ,CAAa,CAAC,MAAD,EAAQ,OAAR,CAAb,CADa;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAAA,oCAEe5G,IAAI6G,IAFnB,EAEZ9C,IAFY,aAEZA,IAFY,EAEP0D,EAFO,aAEPA,EAFO,EAEJC,WAFI,aAEJA,WAFI,EAEQ5H,KAFR,aAEQA,KAFR;AAAA;AAIT6H,0BAJS,GAIN,IAAI,+DAAJ,CAAW,EAAC5D,UAAD,EAAM0D,MAAN,EAASC,wBAAT,EAAqB5H,YAArB,EAAX,CAJM;AAAA;AAAA,+BAKK6H,GAAGZ,IAAH,EALL;;AAAA;AAKTa,+BALS;AAAA,yDAMN3H,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAACwH,QAAOD,OAAR,EAAlB,CANM;;AAAA;AAAA;AAAA;;AASbzF,gCAAQ3B,KAAR;AATa,yDAUNP,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAACG,kBAAD,EAAlB,CAVM;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAV;;AAAA;AAAA;AAAA;AAAA,GAAJ;;AAeP;AACO,IAAIsH;AAAA,+KAAY,kBAAM9H,GAAN,EAAUC,GAAV;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BAEG,+DAAA8H,CAAOC,IAAP,CAAY,EAAZ,CAFH;;AAAA;AAEXC,8BAFW;AAAA,0DAGRhI,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAAC6H,UAASD,MAAV,EAAlB,CAHQ;;AAAA;AAAA;AAAA;;AAKf9F,gCAAQ3B,KAAR;AALe,0DAMRP,IAAII,SAAJ,CAAc,GAAd,EAAkB,EAACG,mBAAD,EAAlB,CANQ;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAZ;;AAAA;AAAA;AAAA;AAAA,GAAJ,C;;;;;;;;AClBP,IAAI2H,eAAelK,SAASC,MAAT,CAAgB;AACjC6F,QAAK,EAAC3F,MAAK,QAAN,EAD4B;AAEjCqJ,MAAG,EAACrJ,MAAK,QAAN,EAF8B;AAGjCsJ,eAAY,EAACtJ,MAAK,QAAN,EAHqB;AAIjC0B,SAAM,EAAC1B,MAAK,QAAN;;AAJ2B,CAAhB,CAAnB;AAQA+J,aAAa1J,MAAb,CAAoBC,iBAApB;;AAEA,yDAAeT,SAAS6B,KAAT,CAAe,QAAf,EAAwBqI,YAAxB,CAAf,E;;;;;;;ACXA;AAAA;;;;;AAKe,SAASC,IAAT,CAAcpI,GAAd,EAAmBC,GAAnB,EAAwBC,IAAxB,EAA8B;AAC3CD,MAAIoI,MAAJ,CAAW,6BAAX,EAA0C,GAA1C;AACApI,MAAIoI,MAAJ,CAAW,8BAAX,EAA2C,uCAA3C;AACApI,MAAIoI,MAAJ,CAAW,8BAAX,EAA2C,6HAA3C;AACApI,MAAIoI,MAAJ,CAAW,kCAAX,EAA+C,MAA/C;AACAnI;AACD,C;;;;;;;ACXD;AAAA;;;;;AAKA;AACA,yDAAe,UAACF,GAAD,EAAMC,GAAN,EAAWC,IAAX,EAAmB;AACjCoI,YAAWtI,GAAX,EAAeC,GAAf;;AAEAC;AACA,CAJD;AAKA;AACA,IAAIoI,aAAW,SAAXA,UAAW,CAACtI,GAAD,EAAKC,GAAL,EAAW;AACzBA,KAAII,SAAJ,GAAc,yDAAAkI,CAAQtI,GAAtB;AACAD,KAAIC,GAAJ,GAAQA,GAAR;AACAD,KAAI4G,QAAJ,GAAa,yDAAA2B,CAAQvI,GAArB;AAGA,CAND,C;;;;;;;;ACZA;AAAA;;;;;;AAMA;;;;;AAKA,IAAIwI,WAAW,SAAXA,QAAW,CAACC,MAAD,EAASC,IAAT,EAAkB;AAC/B,MAAIC,YAAY,EAAhB;AACA,MAAIC,eAAe,EAAnB;AACAF,OAAKhE,OAAL,CAAa,eAAO;AAClBkE,iBAAaC,IAAb,CAAkBjI,GAAlB;AACAH,MAAEC,OAAF,CAAU+H,MAAV,EAAkB,UAACK,WAAD,EAAcC,SAAd,EAA4B;AAC5C,UAAInI,OAAOmI,SAAX,EAAsB;AACpB,YAAIN,OAAO7H,GAAP,KAAe6H,OAAO7H,GAAP,KAAe,IAA9B,IAAsC6H,OAAO7H,GAAP,KAAe,EAAzD,EAA6D;AAC3D+H,oBAAUE,IAAV,CAAejI,GAAf;AACAgI,uBAAaI,GAAb;AACD;AACF;AACF,KAPD;AAQD,GAVD;AAWA,SAAO;AACLL,wBADK;AAELC;AAFK,GAAP;AAID,CAlBD;AAmBA,IAAIK,WAAW,SAAXA,QAAW,CAACR,MAAD,EAASC,IAAT,EAAkB;AAC/B,MAAI;AACF,QAAID,OAAOS,IAAX,EAAiBT,SAASA,OAAOS,IAAhB;;AAEjB,QAAIC,SAAS,SAATA,MAAS,IAAK;AAChB,UAAIC,OAAOV,IAAP,CAAYW,CAAZ,EAAeC,MAAf,GAAwB,CAA5B,EAA+B,IAAIC,QAAQN,SAASI,CAAT,EAAYX,IAAZ,CAAZ,CAA/B,KACK,IAAIa,QAAQF,CAAZ;AACL,aAAOE,KAAP;AACD,KAJD;AAKAb,SAAKc,GAAL,CAAS,gBAAQ;AACf/I,QAAEC,OAAF,CAAU+H,MAAV,EAAkB,UAACgB,CAAD,EAAIC,CAAJ,EAAU;AAC1B,YAAIC,QAAQD,CAAZ,EAAe,OAAOjB,OAAOiB,CAAP,CAAP;AAChB,OAFD;AAGD,KAJD;AAKA,QAAIE,SAAJ;AACA,QAAInB,OAAOa,MAAX,EAAmB,OAAOb,OAAOe,GAAP,CAAWL,MAAX,CAAP,CAAnB,KACK;AACHC,aAAOV,IAAP,CAAYD,MAAZ,EAAoBe,GAApB,CAAwB,eAAO;AAC7Bf,eAAO7H,GAAP,IAAcuI,OAAOV,OAAO7H,GAAP,CAAP,CAAd;AACD,OAFD;AAGA,aAAO6H,MAAP;AACD;AACF,GArBD,CAqBE,OAAOoB,CAAP,EAAU;AACV,WAAOpB,MAAP;AACD;AACF,CAzBD;AA0BA;;;;;;AAMO,SAASzI,GAAT,CAAa8J,YAAb,EAA2BC,aAA3B,EAA0C;AAC/C,MAAI/J,MAAM,IAAV;AAD+C,MAEzCC,GAFyC,GAEjCD,GAFiC,CAEzCC,GAFyC;AAAA,MAGzC4G,IAHyC,GAGhC7G,GAHgC,CAGzC6G,IAHyC;;AAI/C,MAAI,CAACiD,YAAL,EAAmBA,eAAe,EAAf;AACnB,MAAI,CAACC,aAAL,EAAoBA,gBAAgB,EAAhB;;AAEpB,MAAIC,aAAaxB,SAAS3B,IAAT,EAAeiD,YAAf,EAA6BlB,YAA9C;AACA,MAAIqB,iBAAiBzB,SAAS3B,IAAT,EAAekD,aAAf,EAA8BpB,SAAnD;;AAEA,MAAInI,QAAQ,EAAZ;AACA,MAAIwJ,WAAWV,MAAX,GAAoB,CAAxB,EACE9I,QACE,wDACAC,EAAE4C,IAAF,CAAO2G,UAAP,EAAmB,KAAnB,CADA,GAEA,IAHF;AAIF,MAAID,cAAcT,MAAd,GAAuB,CAA3B,EACE9I,QACE,wDACAC,EAAE4C,IAAF,CAAO0G,aAAP,EAAsB,KAAtB,CADA,GAEA,IAHF;;AAKF,MAAIvJ,SAAS,EAAb,EAAiB,OAAO,IAAP;AACjBP,MAAII,SAAJ,CAAc,GAAd,EAAmB;AACjBG;AADiB,GAAnB;AAGA,SAAO,KAAP;AACD;AACD;;;;;;AAMO,SAASP,GAAT,CAAawD,MAAb,EAAqBoD,IAArB,EAA2BqD,QAA3B,EAAqC;AAC1C,MAAI,CAACzG,MAAL,EAAaA,SAAS,GAAT;AACb,MAAIoD,IAAJ,EACE,IAAIxC,UAAU8F,MAAV,CAAiBhD,KAAKC,SAAL,CAAeP,IAAf,CAAjB,CAAJ,EAA4C;AAC1C,QAAIA,KAAKqC,IAAT,EAAerC,OAAOA,KAAKqC,IAAZ;;AAEf,QAAIkB,kBAAkB,CAAC,KAAD,CAAtB;AACA,QAAI,CAACF,QAAD,IAAaA,SAASZ,MAAT,IAAmB,CAApC,EAAuCY,WAAWE,eAAX;AACvCvD,WAAOoC,SAASpC,IAAT,EAAeqD,QAAf,CAAP;AACD;AACH,MAAIzG,UAAU,GAAd,EAAmBtB,QAAQkI,EAAR,CAAW,aAAX,EAA0B,GAA1B,EAA+B,KAA/B,EAAsCxD,IAAtC,EAAnB,KACK1E,QAAQ3B,KAAR,CAAc,aAAd,EAA6BiD,MAA7B,EAAqC,KAArC,EAA4CoD,IAA5C;AACL,SAAO,KAAKpD,MAAL,CAAYA,MAAZ,EAAoBV,IAApB,CAAyB8D,IAAzB,CAAP;AACD;;AAED,yDAAe;AACb7G,UADa;AAEbC;AAFa,CAAf,E","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 5);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 53ebec7677f84f334564","module.exports = require(\"regenerator-runtime\");\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/babel-runtime/regenerator/index.js\n// module id = 0\n// module chunks = 0","/**\r\n *          .::USER MODEL::.\r\n * User Mongoose model\r\n * \r\n */\r\nimport Hash from './sensitive/Hash';\r\n\r\n\r\nvar userSchema = mongoose.Schema({\r\n\r\n\tfName: {\r\n\t\ttype: String,\r\n\t\t\r\n\t},lName: {\r\n\t\ttype: String,\r\n\t\t\r\n\t},username: {\r\n\t\ttype: String,\r\n\t\trequired: true\r\n\t},\r\n});\r\n\r\nuserSchema.plugin(mongooseTimestamp);\r\n//UPDATING HASH WHEN PASSWORD IS CHANGED\r\nuserSchema.virtual('password').set(async function(password){\r\n\treturn await Hash.update({user:this._id},{user:this._id,hash:password},{upsert:true});\r\n})\r\n\r\n//AUTHORIZE USER\r\nuserSchema.statics.authorize= function(user){\r\n\treturn new Promise(async function(resolve,reject){\r\n\t\ttry{\r\n\t\t\t//FINDING HASH\r\n\t\t\tvar savedHash=await Hash.findOne({user:user._id});\r\n\t\t\tif(!savedHash) return reject(\"hash was not found\");\r\n\r\n\t\t\t//COMPARING PASSWORD AND HASH\r\n\t\t\tvar match=await bcrypt.compare(user.password,savedHash.hash);\r\n\t\t\tif(match) return resolve(true);\r\n\t\t\treturn resolve(false);\r\n\t\t}catch(e){\r\n\t\t\treturn reject(e);\r\n\t\t}\r\n\r\n\t})\r\n}\r\n\r\n\r\n\r\nexport default mongoose.model('User', userSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/User.js","module.exports = require(\"lodash\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"lodash\"\n// module id = 2\n// module chunks = 0","/**\r\n *          .::AUTHENTICATION::.\r\n * Authentication operations belong here.\r\n * \r\n */\r\nimport User from '../models/User';\r\nimport {\r\n\tverify\r\n} from './Token';\r\n//The KEY that has token\r\nconst TOKENKEY=\"x-access-token\"\r\n\r\n//API AUTHENTICATION\r\nexport default async function auth(req, res, next) {\r\n\t//Getting Token\r\n\tif (req.headers[TOKENKEY]) var api_token = req.headers[TOKENKEY];\r\n\t//TOKENNOTFOUND Handling\r\n\tif (!api_token) return res.validSend(401, \"The following keys are required in request header: \\n \"+TOKENKEY+\"\\n\")\r\n\t//Verifying token\r\n\tvar verified = await verify(api_token);\r\n\t//Verifying token error handling\r\n\tif (verified.error) return res.validSend(401, verified);\r\n\t//Adding verified user information to request object.\r\n\t_.mapKeys(verified, (value, key) => {\r\n\t\treturn req[key] = value;\r\n\t});\r\n\r\n\tnext();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Auth.js","/**\r\n *          .::TOKENIZATION::.\r\n * Generating, Verifying and all related operations to Token are here.\r\n * \r\n */\r\nimport User from '../models/User';\r\n\r\n//TOKEN CONFIGURATION\r\n/**\r\n *  basedCollection: Name of the schema that token is generating from it.\r\n *  useridKey: Name of the field that userid is stored there in the told collection\r\n * \r\n * Example: {\r\n *      collection: 'Device',\r\n *      useridKey: 'userid'\r\n *  } \r\n * This example generates token based on user's Device.\r\n */\r\nlet config = {\r\n    basedCollection: 'User',\r\n    useridKey: '_id'\r\n}\r\n\r\nlet validationConfig = () => {\r\n    if (!config) return {\r\n        valid: false,\r\n        error: \"config is not defined\"\r\n    }\r\n    if (!config.basedCollection) return {\r\n        valid: false,\r\n        error: \"collection name is not defined\"\r\n    }\r\n    if (!config.useridKey) return {\r\n        valid: false,\r\n        error: \"userid key is not defined\"\r\n    }\r\n    return {\r\n        valid: true\r\n    }\r\n\r\n}\r\n//GENERATING TOKEN\r\n/**\r\n *  @param {string} userid User unique identifier\r\n *  @param {string} docid Optional- Unique Identifier of basedCollection's document that is related to user. If it's null, this function will find it in database automatically. \r\n */\r\nexport default async(userid, docid) => {\r\n    //CHECKING TOKENIZATION CONFIG\r\n    var validation = validationConfig();\r\n    if (!validation.valid) return {\r\n        error: validation.error\r\n    };\r\n    var {\r\n        basedCollection,\r\n        useridKey\r\n    } = config;\r\n    //IF BASEDCOLLECTION IS USER, USERID AND _ID SHOULD BE SAME.\r\n    if (basedCollection == 'User') return await jwt.sign({\r\n        userid,\r\n        basedCollection,\r\n        _id: userid\r\n    },process.env.JWT_SECRET);\r\n    let schema = mongoose.model(basedCollection);\r\n    //IF DOCID IS NOT DEFINED, FIND IT IN BASEDCOLLECTION\r\n    if (!docid) {\r\n        let doc = await schema.findOne({\r\n            [useridKey]: userid\r\n        });\r\n        if (!doc) return {\r\n            error: \"No \" + basedCollection + \"'s document with passed \" + useridKey + \" was found.\"\r\n        }\r\n        docid=doc._id;\r\n    }\r\n    //GENERATING TOKEN\r\n    return await jwt.sign({\r\n        userid,\r\n        basedCollection,\r\n        docid\r\n    },process.env.JWT_SECRET);\r\n\r\n}\r\n//VERIFYING TOKEN\r\nexport let verify=async(token)=>{\r\n    try{\r\n        //VERIFYING\r\n        var authenticationInfo=await jwt.verify(token,process.env.JWT_SECRET);\r\n        var {basedCollection,userid,docid} =authenticationInfo;\r\n        //FINDING USER OBJECT\r\n        var user=await User.findById(userid);\r\n        var result={user};\r\n\r\n        if(basedCollection!='User'){\r\n         //FINDING BASEDCOLLECTION DOCUMENT\r\n        var schema=mongoose.model(basedCollection);\r\n        var doc=await schema.findById(docid);\r\n        result[basedCollection]=doc;\r\n        }\r\n        //RETURNING FOUND OBJECTS\r\n        return result\r\n        \r\n    }catch(e){\r\n        //INVALID TOKEN\r\n        return {error:\"Token is not valid.\"}\r\n    }\r\n\r\n}\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/Token.js","/**\r\n *          .::MAIN FILE::.\r\n * \r\n * \r\n */\r\nimport vars from \"./globals\";\r\nimport './config/env';\r\n\r\nimport Project from './config/project';\r\nif (process.env.projectMode == \"Production\") {\r\n  //Don't print logs in production mode\r\n  console.config({\r\n    activeLevel: 2\r\n  })\r\n}\r\n//STARTUP\r\nconsole.intro({\r\n  Name: Project.Name,\r\n  Description: Project.Description,\r\n  Notes: Project.Notes,\r\n  Mode: process.env.projectMode\r\n});\r\n\r\nimport './config/database';\r\nimport routes from './app/routes';\r\nimport CORS from './app/middlewares/CORS';\r\nimport ExpressPlugins from './app/middlewares/ExpressPlugins';\r\n\r\nconst app = express();\r\n\r\n\r\n// Middlewares\r\napp.use(bodyParser.json());\r\napp.use(CORS);\r\napp.use(ExpressPlugins);\r\n\r\n// Routes\r\nroutes.post('/', (req, res) => res.json({\r\n  message: Project.Name+ ' API'\r\n}));\r\napp.use('/api', routes);\r\napp.use(express.static(path.join(__dirname, '../public')));\r\n\r\napp.use(function (req, res, next) {\r\n  var err = new Error('Not Found');\r\n  err.status = 404;\r\n  next(err);\r\n});\r\napp.use((err,req,res,next)=>{\r\n  if(!err) return res.validSend(201,{});\r\n  if(!err.status)err.status=500;\r\n  return res.status(err.status).json({error:err.message})\r\n})\r\n\r\nconst port = process.env.API_PORT || 5000;\r\n\r\n\r\napp.listen(port, (err) => {\r\n  if (err) {\r\n    console.error(err)\r\n  }\r\n\r\n  console.info(`listening on port`, Number(port))\r\n});\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","/**\r\n *          .::GLOBALS::.\r\n * ALL DATA THAT SHOULD BE AVAILABLE EVERYWHERE\r\n * \r\n */\r\nimport _ from 'lodash';\r\nimport modules from './modules';\r\n_.mapKeys(modules, (value, name) => {\r\n    global[name] = value;\r\n})\r\n\r\nimport vars from './vars';\r\nglobal.globals = vars;\n\n\n// WEBPACK FOOTER //\n// ./src/globals/index.js","/**\r\n *          .::GLOBAL MODULES::.\r\n * Require any module here and it will be available everywhere\r\n * \r\n */\r\nexport default {\r\n    //Sherytech modules\r\n    sherylogger:require('shery-logger'),\r\n    \r\n    //Data storing modules\r\n    mongoose: require('mongoose'),\r\n    mongooseTimestamp:require('mongoose-timestamp'),\r\n    \r\n    //Tool modules\r\n    _: require('lodash'),\r\n    async: require('async'),\r\n    validator: require('validator'),\r\n    logger: require('morgan'),\r\n    bodyParser: require('body-parser'),\r\n    path:require('path'),\r\n\r\n    //Encryption modules\r\n    bcrypt:require('bcrypt'),\r\n    jwt:require('jsonwebtoken'),\r\n    \r\n    //Server handling modules\r\n    express: require('express'),\r\n\r\n    //Configuration modules\r\n    dotenv:require('dotenv'),\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/modules.js","module.exports = require(\"shery-logger\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"shery-logger\"\n// module id = 9\n// module chunks = 0","module.exports = require(\"mongoose\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"mongoose-timestamp\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"mongoose-timestamp\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"async\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"async\"\n// module id = 12\n// module chunks = 0","module.exports = require(\"validator\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"validator\"\n// module id = 13\n// module chunks = 0","module.exports = require(\"morgan\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"morgan\"\n// module id = 14\n// module chunks = 0","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 15\n// module chunks = 0","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 16\n// module chunks = 0","module.exports = require(\"bcrypt\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"bcrypt\"\n// module id = 17\n// module chunks = 0","module.exports = require(\"jsonwebtoken\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"jsonwebtoken\"\n// module id = 18\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 20\n// module chunks = 0","/**\r\n *          .::GLOBAL VARIABLES::. \r\n * \r\n */\r\nexport default {\r\n    //Add global variables here\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/globals/vars.js","/**\r\n *          .::ENVIRONMENT PARSING::.\r\n * Parsing .env files and defining Project mode(Development, Production)\r\n * \r\n */\r\nlet dotenvPath = \"../../.dev.env\"\r\nlet projectMode = \"Development\"\r\nprocess\r\n  .argv\r\n  .forEach((val, index, array) => {\r\n    switch (val) {\r\n      case \"--production\":\r\n        projectMode = \"Production\"\r\n        return dotenvPath = '../../.env';\r\n        break;\r\n\r\n      //Add more commands here\r\n      default:\r\n    }\r\n  });\r\n\r\ndotenv.config({\r\n  path: path.resolve(__dirname, dotenvPath),\r\n});\r\nprocess.env.projectMode=projectMode;\n\n\n// WEBPACK FOOTER //\n// ./src/config/env.js","/**\r\n *          .::PROJECT CONFIGURATION::.\r\n * Project configuration and all project's information are defined here.\r\n * \r\n */\r\nlet Project = {\r\n\r\n    Name: \"mdc Project\",\r\n    Description: \"Project Description\",\r\n    Notes: [\"Some Notes to think\", \"List of works to do\", ]\r\n\r\n}\r\nlet DevProjectInfoKeys = [\r\n    \"Notes\",\r\n    //Add Key names that shouldn't appear in production mode\r\n]\r\nif (process.env.projectMode == \"Production\") {\r\n    Project = _.omit(Project, DevProjectInfoKeys)\r\n}\r\nexport default Project;\n\n\n// WEBPACK FOOTER //\n// ./src/config/project.js","/**\r\n *          .::DATABASE CONFIGURATION::.\r\n * Connecting to Mongo Server and Database Configuration\r\n * \r\n */\r\nmongoose.Promise = global.Promise;\r\n\r\nconst {\r\n\tDB_USERNAME,\r\n\tDB_PASSWORD,\r\n\tDB_HOST,\r\n\tDB_PORT,\r\n\tDB_NAME\r\n} = process.env;\r\n\r\nconst mongoOptions = {\r\n\tuseMongoClient: true,\r\n};\r\n\r\n//GENERATING MONGODB URI\r\nvar loginInfo = \"\";\r\nvar authSource = \"\";\r\nif (DB_USERNAME) {\r\n\tloginInfo = DB_USERNAME + \":\" + DB_PASSWORD + \"@\";\r\n\tauthSource = \"?authSource=\" + DB_AUTHSOURCE;\r\n}\r\nvar uri = \"mongodb://\" + loginInfo + DB_HOST + \":\" + DB_PORT + \"/\" + DB_NAME + authSource;\r\n\r\n//CONNECTING TO MONGODB SERVER\r\nmongoose.connect(uri, mongoOptions);\r\nconst db = mongoose.connection;\r\n\r\n//LOGS\r\ndb.on('error', console.error.bind(console, 'MongoDB connection error:'));\r\ndb.once('open', () => console.log('Connected to mongo server.'));\n\n\n// WEBPACK FOOTER //\n// ./src/config/database.js","/**\r\n *          .::ROUTES::.\r\n * All routes are imported here.\r\n * \r\n */\r\nconst routes = express.Router();\r\nimport users from './users';\r\nimport switches from './switches';\r\n\r\n//USING ROUTES\r\nroutes.use('/users', users);\r\nroutes.use('/switches', switches);\r\n\r\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/index.js","/**\r\n *          .::USER ROUTES::.\r\n * All User's apis are routed here.\r\n * \r\n */\r\nconst routes = express.Router();\r\n\r\nimport Auth from '../middlewares/Auth';\r\nimport {\r\n\tregister,\r\n\tlogin,\r\n\tme\r\n} from '../controllers/UsersController'\r\n\r\n//ENDPOINTS\r\nroutes.post('/register', register);\r\nroutes.post('/login', login);\r\nroutes.post('/me', Auth, me);\r\n\r\n\r\n\r\n\r\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/users.js","module.exports = require(\"regenerator-runtime\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"regenerator-runtime\"\n// module id = 27\n// module chunks = 0","/**\r\n *          .::HASH MODEL::.\r\n * User's password hashes model\r\n * \r\n */\r\n\r\nvar hashSchema = mongoose.Schema({\r\n\r\n    user: {\r\n        type: mongoose.SchemaTypes.ObjectId,\r\n        ref: \"User\"\r\n    },\r\n    hash: String,\r\n});\r\n\r\nhashSchema.plugin(mongooseTimestamp)\r\n\r\n//HASHING PASSWORD\r\nasync function doHash(next) {\r\n    try {\r\n        var password = this.getUpdate().$set.hash;\r\n        this.getUpdate().$set.hash = await bcrypt.hash(password, 10);\r\n        next();\r\n    } catch (e) {\r\n        next(e);\r\n    }\r\n}\r\nhashSchema.pre('update', doHash)\r\nhashSchema.pre('findOneAndUpdate', doHash)\r\n\r\n\r\nexport default mongoose.model('Hash', hashSchema);\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/sensitive/Hash.js","/**\r\n *          .::USER CONTROLLER::.\r\n * All related operations to User belong here. \r\n * \r\n */\r\nimport User from '../models/User';\r\nimport tokenize from '../middlewares/Token'\r\n  \r\n\r\n\r\n/*          POST /api/users/register            */\r\nexport let register = async(req, res, next) => {\r\n    //REQUEST VALIDATION\r\n    if (!req.validate([\"username\", \"password\"])) return;\r\n\r\n    var {\r\n        fName,\r\n        lName,\r\n        username,\r\n        password\r\n    } = req.body;\r\n    //CHECK IF USER ALREADY EXISTS\r\n    if(await User.findOne({username})) return res.validSend(409,{error:\"username already exists.\"});\r\n    //CREATING NEW USER OBJECT\r\n    var newUser = new User({\r\n        fName,\r\n        lName,\r\n        username,\r\n        password\r\n    });\r\n    try {\r\n        //SAVING USER\r\n        var savedUser = await newUser.save();\r\n        //GENERATING TOKEN\r\n        var token = await tokenize(savedUser._id);\r\n\r\n        //OK RESPONSE\r\n        res.validSend(200, {\r\n            registered: true,\r\n            message: \"User has been registered successfully.\",\r\n            token: token\r\n        });\r\n    } catch (e) {\r\n        //FAILURE RESPONSE\r\n        res.validSend(500, {\r\n            error: JSON.stringify(e)\r\n        });\r\n    }\r\n\r\n}\r\n/*          POST /api/users/login            */\r\nexport let login = async(req, res, next) => {\r\n    //REQUEST VALIDATION    \r\n    if (!req.validate([\"username\", \"password\"])) return;\r\n\r\n    var {\r\n        username,\r\n        password\r\n    } = req.body;\r\n    try {\r\n        //FINDING USER\r\n        var user = await User.findOne({\r\n            username\r\n        });\r\n        //AUTHENTICATING USER\r\n        var authenticated = await User.authorize({\r\n            _id: user._id,\r\n            password\r\n        });\r\n\r\n        //GENERATING TOKEN\r\n        if (authenticated)\r\n            var token = await tokenize(user._id);\r\n\r\n        //OK RESPONSE\r\n        res.validSend(200, {\r\n            authenticated,\r\n            token\r\n        })\r\n    } catch (e) {\r\n        //FAILURE RESPONSE\r\n        res.validSend(500, {\r\n            error: JSON.stringify(e)\r\n        })\r\n    }\r\n}\r\n/*          POST /api/users/me            */\r\nexport let me = async(req, res) => {\r\n    //OK RESPONSE\r\n    res.validSend(200, req.user);\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/controllers/UsersController.js","/**\n *          .::SWITCH ROUTES::.\n * All Switch's apis are routed here.\n * \n */\nconst routes = express.Router();\n\nimport Auth from '../middlewares/Auth';\nimport { newSwitch ,allSwitches} from '../controllers/SwitchesController'\n\n\n//ENDPOINTS\nroutes.post('/new',Auth, newSwitch);\nroutes.post('/all',Auth, allSwitches);\n\n\n\n\n\n\nexport default routes;\n\n\n// WEBPACK FOOTER //\n// ./src/app/routes/switches.js","import Switch from '../models/Switch'\n\n/*          POST /api/switches/new            */\nexport let newSwitch=async(req,res)=>{\n    if(!req.validate([\"name\",\"model\"]))return;\n    var {name,ip,description,model}=req.body;\n    try{\n        var sw=new Switch({name,ip,description,model});\n        var savedSW=await sw.save();\n        return res.validSend(200,{switch:savedSW});\n\n    }catch(e){\n        console.error(e);\n        return res.validSend(500,{error:e});\n    }\n\n}\n\n/*          POST /api/switches/all            */\nexport let allSwitches=async(req,res)=>{\n    try{\n        var swList= await Switch.find({});\n        return res.validSend(200,{switches:swList});\n    }catch(e){\n        console.error(e);\n        return res.validSend(500,{error:e});\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/controllers/SwitchesController.js","\r\nvar switchSchema = mongoose.Schema({\r\n  name:{type:'string'},\r\n  ip:{type:'string'},\r\n  description:{type:'string'},\r\n  model:{type:'string'}, \r\n \r\n\r\n});\r\nswitchSchema.plugin(mongooseTimestamp);\r\n\r\nexport default mongoose.model('Switch',switchSchema);\r\n\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/models/Switch.js","/**\r\n *          .::CORS::.\r\n * Cross-Origin Resource Sharing configuration\r\n * \r\n */\r\nexport default function CORS(req, res, next) {\r\n  res.header('Access-Control-Allow-Origin', '*');\r\n  res.header('Access-Control-Allow-Methods', 'PUT, GET, HEAD, POST, DELETE, OPTIONS');\r\n  res.header('Access-Control-Allow-Headers', 'Origin, X-Requested-With, X-Api-Token, Content-Type, Accept, Authorization, Access-Control-Allow-Credentials,x-access-token');\r\n  res.header('Access-Control-Allow-Credentials', 'true');\r\n  next();\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/CORS.js","/**\r\n *          .::EXPRESS PLUGINS::.\r\n * Express plugins and all adding data to req and res are here.\r\n * \r\n */\r\nimport isValid from './isValid';\r\nexport default (req, res, next)=> {\r\n\tvalidators(req,res);\r\n\r\n\tnext();\r\n}\r\n//ADDING REQUEST AND RESPONSE VALIDATORS TO REQUEST\r\nlet validators=(req,res)=>{\r\n\tres.validSend=isValid.res;\r\n\treq.res=res;\r\n\treq.validate=isValid.req;\r\n\t\r\n\t\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/ExpressPlugins.js","/**\r\n *          .::VALIDATION::.\r\n * All validation operations belong here.\r\n *\r\n */\r\n\r\n/**\r\n * Returns a json object that has `foundKeys` and `notFoundKeys`\r\n * @param {*} object\r\n * @param {*[]} keys keys to find in `object`\r\n */\r\nlet findKeys = (object, keys) => {\r\n  var foundKeys = [];\r\n  var notFoundKeys = [];\r\n  keys.forEach(key => {\r\n    notFoundKeys.push(key);\r\n    _.mapKeys(object, (objectValue, objectKey) => {\r\n      if (key == objectKey) {\r\n        if (object[key] && object[key] != null && object[key] != \"\") {\r\n          foundKeys.push(key);\r\n          notFoundKeys.pop();\r\n        }\r\n      }\r\n    });\r\n  });\r\n  return {\r\n    foundKeys,\r\n    notFoundKeys\r\n  };\r\n};\r\nlet deepOmit = (object, keys) => {\r\n  try {\r\n    if (object._doc) object = object._doc;\r\n\r\n    let mapper = o => {\r\n      if (Object.keys(o).length > 0) var level = deepOmit(o, keys);\r\n      else var level = o;\r\n      return level;\r\n    };\r\n    keys.map(okey => {\r\n      _.mapKeys(object, (v, k) => {\r\n        if (okey == k) delete object[k];\r\n      });\r\n    });\r\n    var newObject;\r\n    if (object.length) return object.map(mapper);\r\n    else {\r\n      Object.keys(object).map(key => {\r\n        object[key] = mapper(object[key]);\r\n      });\r\n      return object;\r\n    }\r\n  } catch (e) {\r\n    return object;\r\n  }\r\n};\r\n/**\r\n * request validation\r\n * @param requiredKeys {string[]} Keys that are required in req.body\r\n * @param forbiddenKeys {string[]} Keys that are not allowed to be in req.body\r\n *\r\n */\r\nexport function req(requiredKeys, forbiddenKeys) {\r\n  var req = this;\r\n  var { res } = req;\r\n  var { body } = req;\r\n  if (!requiredKeys) requiredKeys = [];\r\n  if (!forbiddenKeys) forbiddenKeys = [];\r\n\r\n  var missedKeys = findKeys(body, requiredKeys).notFoundKeys;\r\n  var notAllowedKeys = findKeys(body, forbiddenKeys).foundKeys;\r\n\r\n  var error = \"\";\r\n  if (missedKeys.length > 0)\r\n    error =\r\n      \"The following keys are required in request body:\\n \" +\r\n      _.join(missedKeys, \" , \") +\r\n      \"\\n\";\r\n  if (forbiddenKeys.length > 0)\r\n    error =\r\n      \"The following keys are forbidden in request body:\\n\" +\r\n      _.join(forbiddenKeys, \" , \") +\r\n      \"\\n\";\r\n\r\n  if (error == \"\") return true;\r\n  res.validSend(400, {\r\n    error\r\n  });\r\n  return false;\r\n}\r\n/**\r\n *\r\n * @param {number} status http status code\r\n * @param {*} body response body\r\n * @param {string[]} omitKeys Optional - keys to omit from response body\r\n */\r\nexport function res(status, body, omitKeys) {\r\n  if (!status) status = 200;\r\n  if (body)\r\n    if (validator.isJSON(JSON.stringify(body))) {\r\n      if (body._doc) body = body._doc;\r\n\r\n      var defaultOmitKeys = [\"__v\"];\r\n      if (!omitKeys || omitKeys.length <= 0) omitKeys = defaultOmitKeys;\r\n      body = deepOmit(body, omitKeys);\r\n    }\r\n  if (status == 200) console.ok(\"RESPONSE > \", 200, \" : \", body);\r\n  else console.error(\"RESPONSE > \", status, \" : \", body);\r\n  return this.status(status).json(body);\r\n}\r\n\r\nexport default {\r\n  req,\r\n  res\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// ./src/app/middlewares/isValid.js"],"sourceRoot":""}